---
// BlogCard komponenta za prikaz blog posta u listi

export interface Props {
  post: {
    slug: string;
    title: string;
    description: string;
    author: string;
    publishDate: Date;
    image: string;
    category?: string;
    tags?: string[];
    featured?: boolean;
  };
}

const { post } = Astro.props;

// Format date
const formatDate = (date: Date) => {
  return new Intl.DateTimeFormat('hr-HR', {
    day: 'numeric',
    month: 'long',
    year: 'numeric'
  }).format(date);
};

// Reading time estimation (assuming 200 words per minute)
const readingTime = 5; // Default 5 minutes, will be dynamic later
---

<article class="blog-card">
  <a href={`/blog/${post.slug}`} class="blog-card__image-link">
    <div class="blog-card__image">
      <img
        src={post.image}
        alt={post.title}
        loading="lazy"
      />
    </div>
  </a>

  <div class="blog-card__content">
    {post.category && (
      <span class="blog-card__category">{post.category}</span>
    )}

    <h3 class="blog-card__title">
      <a href={`/blog/${post.slug}`}>{post.title}</a>
    </h3>

    <p class="blog-card__description">
      {post.description}
    </p>

    <div class="blog-card__meta">
      <div class="blog-card__meta-left">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
          <line x1="16" y1="2" x2="16" y2="6"></line>
          <line x1="8" y1="2" x2="8" y2="6"></line>
          <line x1="3" y1="10" x2="21" y2="10"></line>
        </svg>
        <time datetime={post.publishDate.toISOString()}>
          {formatDate(post.publishDate)}
        </time>
      </div>

      <div class="blog-card__meta-right">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="10"></circle>
          <polyline points="12 6 12 12 16 14"></polyline>
        </svg>
        <span>{readingTime} min čitanja</span>
      </div>
    </div>

    {post.tags && post.tags.length > 0 && (
      <div class="blog-card__tags">
        {post.tags.slice(0, 3).map(tag => (
          <span class="blog-card__tag">{tag}</span>
        ))}
      </div>
    )}

    <a href={`/blog/${post.slug}`} class="blog-card__read-more">
      Pročitaj više
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="5" y1="12" x2="19" y2="12"></line>
        <polyline points="12 5 19 12 12 19"></polyline>
      </svg>
    </a>
  </div>
</article>

<style>
  .blog-card {
    position: relative;
    background: var(--color-white);
    border-radius: var(--border-radius-xl);
    overflow: hidden;
    box-shadow: var(--shadow-card);
    transition: all var(--transition-base);
    display: flex;
    flex-direction: column;
    height: 100%;
  }

  .blog-card:hover {
    transform: translateY(-4px);
    box-shadow: var(--shadow-lg);
  }

  .blog-card__image-link {
    display: block;
  }

  .blog-card__image {
    position: relative;
    width: 100%;
    height: 240px;
    overflow: hidden;
    background: var(--color-gray-100);
  }

  .blog-card__image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform var(--transition-slow);
  }

  .blog-card:hover .blog-card__image img {
    transform: scale(1.05);
  }

  .blog-card__content {
    padding: var(--space-6);
    display: flex;
    flex-direction: column;
    gap: var(--space-3);
    flex: 1;
  }

  .blog-card__category {
    display: inline-block;
    padding: var(--space-1) var(--space-3);
    background: var(--color-primary);
    color: var(--color-white);
    font-size: var(--text-xs);
    font-weight: var(--font-semibold);
    border-radius: var(--border-radius-base);
    text-transform: uppercase;
    letter-spacing: 0.05em;
    width: fit-content;
  }

  .blog-card__title {
    font-size: var(--text-xl);
    font-weight: var(--font-bold);
    line-height: 1.3;
    margin: 0;
  }

  .blog-card__title a {
    color: var(--text-primary);
    text-decoration: none;
    transition: color var(--transition-fast);
  }

  .blog-card__title a:hover {
    color: var(--color-primary);
  }

  .blog-card__description {
    color: var(--text-secondary);
    font-size: var(--text-base);
    line-height: 1.6;
    margin: 0;
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .blog-card__meta {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--space-4);
    padding-top: var(--space-3);
    border-top: 1px solid var(--border-color);
    color: var(--text-muted);
    font-size: var(--text-sm);
  }

  .blog-card__meta-left,
  .blog-card__meta-right {
    display: flex;
    align-items: center;
    gap: var(--space-2);
  }

  .blog-card__meta svg {
    flex-shrink: 0;
  }

  .blog-card__tags {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-2);
  }

  .blog-card__tag {
    padding: var(--space-1) var(--space-2);
    background: var(--color-gray-100);
    color: var(--text-secondary);
    font-size: var(--text-xs);
    border-radius: var(--border-radius-base);
    transition: all var(--transition-fast);
  }

  .blog-card__tag:hover {
    background: var(--color-primary-light);
    color: var(--color-primary);
  }

  .blog-card__read-more {
    display: inline-flex;
    align-items: center;
    gap: var(--space-2);
    color: var(--color-primary);
    font-weight: var(--font-semibold);
    font-size: var(--text-sm);
    text-decoration: none;
    margin-top: auto;
    transition: gap var(--transition-fast);
  }

  .blog-card__read-more:hover {
    gap: var(--space-3);
  }

  .blog-card__read-more svg {
    transition: transform var(--transition-fast);
  }

  .blog-card__read-more:hover svg {
    transform: translateX(4px);
  }

  /* Mobile adjustments */
  @media (max-width: 768px) {
    .blog-card__image {
      height: 200px;
    }

    .blog-card__content {
      padding: var(--space-4);
    }

    .blog-card__title {
      font-size: var(--text-lg);
    }

    .blog-card__description {
      font-size: var(--text-sm);
    }

    .blog-card__meta {
      flex-direction: column;
      align-items: flex-start;
      gap: var(--space-2);
    }
  }
</style>
