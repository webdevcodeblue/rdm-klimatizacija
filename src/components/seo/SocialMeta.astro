---
import { SITE_CONFIG, getImageUrl, getFullUrl } from '../../config/site';

export interface Props {
  title: string;
  description: string;
  image?: string;
  type?: 'website' | 'article' | 'product';
  price?: number;
  currency?: string;
  availability?: string;
  brand?: string;
  condition?: string;
  publishedDate?: string;
  author?: string;
  tags?: string[];
}

const {
  title,
  description,
  image = '/images/og-default.jpg',
  type = 'website',
  price,
  currency = 'EUR',
  availability = 'in stock',
  brand = SITE_CONFIG.company.name,
  condition = 'new',
  publishedDate,
  author = SITE_CONFIG.company.name,
  tags = []
} = Astro.props;

const siteUrl = SITE_CONFIG.url;
const fullImageUrl = getImageUrl(image);
const currentUrl = getFullUrl(Astro.url.pathname);
---

<!-- Open Graph Basic -->
<meta property="og:title" content={title} />
<meta property="og:description" content={description} />
<meta property="og:image" content={fullImageUrl} />
<meta property="og:image:alt" content={title} />
<meta property="og:url" content={currentUrl} />
<meta property="og:type" content={type} />
<meta property="og:site_name" content={SITE_CONFIG.company.name} />
<meta property="og:locale" content={SITE_CONFIG.seo.locale} />

<!-- Twitter Card -->
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content={title} />
<meta name="twitter:description" content={description} />
<meta name="twitter:image" content={fullImageUrl} />
<meta name="twitter:image:alt" content={title} />
<meta name="twitter:site" content={SITE_CONFIG.seo.twitterHandle} />

<!-- Product Specific -->
{type === 'product' && (
  <>
    <meta property="product:price:amount" content={price?.toString()} />
    <meta property="product:price:currency" content={currency} />
    <meta property="product:availability" content={availability} />
    <meta property="product:condition" content={condition} />
    <meta property="product:brand" content={brand} />

    <!-- Rich Pins for Pinterest -->
    <meta property="og:price:amount" content={price?.toString()} />
    <meta property="og:price:currency" content={currency} />
    <meta property="og:availability" content={availability} />

    <!-- Schema.org for Google -->
    <script type="application/ld+json">
      {JSON.stringify({
        "@context": "https://schema.org",
        "@type": "Product",
        "name": title,
        "description": description,
        "image": fullImageUrl,
        "brand": {
          "@type": "Brand",
          "name": brand
        },
        "offers": {
          "@type": "Offer",
          "priceCurrency": currency,
          "price": price,
          "availability": `https://schema.org/${availability === 'in stock' ? 'InStock' : 'OutOfStock'}`,
          "itemCondition": `https://schema.org/${condition === 'new' ? 'NewCondition' : 'UsedCondition'}`,
          "seller": {
            "@type": "Organization",
            "name": SITE_CONFIG.company.name
          }
        }
      })}
    </script>
  </>
)}

<!-- Article Specific -->
{type === 'article' && (
  <>
    <meta property="article:published_time" content={publishedDate} />
    <meta property="article:author" content={author} />
    {tags.map(tag => (
      <meta property="article:tag" content={tag} />
    ))}

    <!-- Schema.org for Articles -->
    <script type="application/ld+json">
      {JSON.stringify({
        "@context": "https://schema.org",
        "@type": "BlogPosting",
        "headline": title,
        "description": description,
        "image": fullImageUrl,
        "datePublished": publishedDate,
        "author": {
          "@type": "Person",
          "name": author
        },
        "publisher": {
          "@type": "Organization",
          "name": SITE_CONFIG.company.name,
          "logo": {
            "@type": "ImageObject",
            "url": getImageUrl(SITE_CONFIG.brand.logo)
          }
        },
        "keywords": tags.join(', ')
      })}
    </script>
  </>
)}

<!-- LinkedIn -->
<meta property="og:linkedin:title" content={title} />
<meta property="og:linkedin:description" content={description} />
<meta property="og:linkedin:image" content={fullImageUrl} />

<!-- WhatsApp -->
<meta property="og:whatsapp:title" content={title} />
<meta property="og:whatsapp:description" content={description} />
<meta property="og:whatsapp:image" content={fullImageUrl} />